<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>EKA2l1 progress (part 4)</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="http://localhost:2368/assets/built/screen.css?v=b5a2b1eda7" />

    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="amp/index.html" />
    
    <meta property="og:site_name" content="pent0" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="EKA2l1 progress (part 4)" />
    <meta property="og:description" content="6:50 AM 18/1/2018I got bored on EKA2L1 a little bit. I decided to try building a toolchain for Symbian in pure C. So far it&#x27;s good, having CMake support integrated. I just wish I could write a debugger and a SIS maker also.22/1/2019 7:" />
    <meta property="og:url" content="http://localhost:2368/eka2l1-progress-part-4/" />
    <meta property="og:image" content="http://localhost:2368/content/images/2019/03/unknown.png" />
    <meta property="article:published_time" content="2019-01-22T12:15:26.000Z" />
    <meta property="article:modified_time" content="2019-05-07T14:41:46.000Z" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="EKA2l1 progress (part 4)" />
    <meta name="twitter:description" content="6:50 AM 18/1/2018I got bored on EKA2L1 a little bit. I decided to try building a toolchain for Symbian in pure C. So far it&#x27;s good, having CMake support integrated. I just wish I could write a debugger and a SIS maker also.22/1/2019 7:" />
    <meta name="twitter:url" content="http://localhost:2368/eka2l1-progress-part-4/" />
    <meta name="twitter:image" content="http://localhost:2368/content/images/2019/03/unknown.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Do Trong Thu" />
    <meta name="twitter:site" content="@hgen264" />
    <meta property="og:image:width" content="806" />
    <meta property="og:image:height" content="454" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "pent0",
        "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:2368/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Do Trong Thu",
        "url": "http://localhost:2368/author/pent0/",
        "sameAs": [
            "https://github.com/eka2l1/eka2l1"
        ]
    },
    "headline": "EKA2l1 progress (part 4)",
    "url": "http://localhost:2368/eka2l1-progress-part-4/",
    "datePublished": "2019-01-22T12:15:26.000Z",
    "dateModified": "2019-05-07T14:41:46.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "http://localhost:2368/content/images/2019/03/unknown.png",
        "width": 806,
        "height": 454
    },
    "description": "6:50 AM 18/1/2018I got bored on EKA2L1 a little bit. I decided to try building a toolchain for Symbian in pure C. So far it&#x27;s good, having CMake support integrated. I just wish I could write a debugger and a SIS maker also.22/1/2019 7:",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:2368/"
    }
}
    </script>

    <script src="http://localhost:2368/public/ghost-sdk.js?v=b5a2b1eda7"></script>
<script>
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "7f9644b78f19"
});
</script>
    <meta name="generator" content="Ghost 2.9" />
    <link rel="alternate" type="application/rss+xml" title="pent0" href="../rss/index.html" />

</head>
<body class="post-template">

    <div class="site-wrapper">

        

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="../index.html">pent0</a>
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="../index.html">Home</a></li>
    <li class="nav-author" role="menuitem"><a href="../author/pent0/index.html">Author</a></li>
    <li class="nav-help" role="menuitem"><a href="https://help.ghost.org">Help</a></li>
</ul>

    </div>
    <div class="site-nav-right">
        <div class="social-links">
                <a class="social-link social-link-tw" href="https://twitter.com/hgen264" title="Twitter" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
        </div>
            <a class="rss-button" href="https://feedly.com/i/subscription/feed/http://localhost:2368/rss/" title="RSS" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
</a>
    </div>
</nav>
    </div>
</header>


<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2019-01-22">22 January 2019</time>
                </section>
                <h1 class="post-full-title">EKA2l1 progress (part 4)</h1>
            </header>

            <figure class="post-full-image">
                <img
                    srcset="../content/images/size/w300/2019/03/unknown.png 300w,
                           ../content/images/size/w600/2019/03/unknown.pngg 600w,
                          ../content/images/size/w1000/2019/03/unknown.pngng 1000w,
                         ../content/images/size/w2000/2019/03/unknown.pngpng 2000w"
                    sizes="(max-width: 800px) 400px,
                            (max-width: 1170px) 700px,
                            1400px"
                    src="../content/images/size/w2000/2019/03/unknown.png"
                    alt="EKA2l1 progress (part 4)"
                />
            </figure>

            <section class="post-full-content">
                <div class="post-content">
                    <p><strong>6:50 AM 18/1/2018</strong></p><figure class="kg-card kg-image-card"><img src="../content/images/2019/01/newepoc.png" class="kg-image"></figure><p>I got bored on EKA2L1 a little bit. I decided to try building a toolchain for Symbian in pure C. So far it's good, having CMake support integrated. I just wish I could write a debugger and a SIS maker also.</p><p>22/1/2019 7:13 PM</p><p>After some hesitations, mainly because I didn't have much idea was will head to me towards, I starts to work on the FBS. It first requests to load a Japanese Font.</p><figure class="kg-card kg-image-card"><img src="../content/images/2019/01/image.png" class="kg-image"></figure><p>It was not weird at all though. It was asking if Japanese language is supported. Either way, we don't have this, and max height is set to 0, so we decline.</p><p>1/2/2019 ??: ??</p><p><img src="https://media.discordapp.net/attachments/431430141319708692/540628797624680459/unknown.png" alt="Analyzer"></p>
<p>The analyzer is practically finished after a few months of keeping it secert. It was supposed to work along with LLVM recompiler, but due to me can't think of a proper cache design for LLVM, the recompiler now still on hold.</p>
<p>The analyzer though, found many subroutines but requires a long time.</p>
<p>4/2/2019 7:02 PM</p><p><img src="https://media.discordapp.net/attachments/431430141319708692/541951204939530240/unknown.png?width=807&amp;height=454" alt="Ecom Progress"></p>
<p>Ecom server progress. With some effort, the plugin descripton file parser is working now! HLE ECom will eventually replaces LLE ECom server</p>
<p>27/2/2019 10:44 AM</p><p><img src="https://media.discordapp.net/attachments/431430141319708692/550338790888046619/unknown.png?width=806&amp;height=454" alt="Input working"></p>
<p>Input working. Input is handle asynced, so right now, there is a little bit of input delay when spamming button too much.</p>
<p>14/3/2019 8:40 PM</p><p>The bitmap drawing work and FBS server bitmap cache has finished. However, it still need some debugging</p><p><img src="https://media.discordapp.net/attachments/431430141319708692/555747200920059924/unknown.png?width=806&amp;height=454" alt="Debug1"></p>
<p>The smiley texture (we need to draw it), is currently empty. We don't know why, but soon I found out.</p><p>I told the driver that this have 1 mipmap, but yet I haven't generate any bitmap at all. Looks like it use the bitmap to draw, so i set layer of mipmap to 0.</p><p><img src="https://media.discordapp.net/attachments/431430141319708692/555758674941968399/unknown.png?width=806&amp;height=454" alt="Debug2"></p>
<p>Yay, the texture shows up.</p><p>And here we go:</p><p><img src="https://media.discordapp.net/attachments/431430141319708692/555774955720146959/unknown.png?width=806&amp;height=454" alt="PP"></p>
<p>The texture is flipped. We don't care about that yet. We need to get some apps running! Thanks smiley.</p><p>8:25 PM 26/3/2018</p><figure class="kg-card kg-image-card"><img src="../content/images/2019/03/image-1.png" class="kg-image"></figure><p>CDL server works, a bunch of DLL got loaded as you see. Those are DLL which contains static data references some layout data that the app want to get. Those plugins layouts are registerd through EComServer, and the references of what UID of data it may contains are in the resource file inside Z drive.</p><p>Now AknSkinServer goes ahead! We need it, than probably we almost done with the AKN framework. About Qt, not so sure! I think they are still based on AKN framework, since the whole OS Gui was build on it. However, the OS has some hack around Qt, that was requested by Nokia, which we need to handle in the future. We are not handling those hacks now.</p><p>11:55 AM 30/3/2019</p><p><img src="https://media.discordapp.net/attachments/463217723934113795/561413284444766228/unknown.png" alt="Image"></p>
<p>Works start on the SKN parser. So far, it has been able to parse some simple blocks. Including: name block, filename block, info block.</p>
<p>22:55 PM 2/4/2019:</p><figure class="kg-card kg-image-card"><img src="../content/images/2019/04/image.png" class="kg-image"></figure><p>The SKN is partially finished. Meaning that it's useable. It has been able to parse bitmap infos, bitmap animation infos, color table, image table, restriction chunk.</p><p>Restriction chunk is a little-bit platform dependent. It means that it will only be parsed when an envrionment condition is met. For example, the chunk will only be evaluated if your environment language is Abaric!</p><p>Either way, I'm also have this written in a short time!</p><figure class="kg-card kg-image-card"><img src="../content/images/2019/04/image-1.png" class="kg-image"></figure><p>MIF parser, needed to get skin's bitmap files. MIF is another archive file type. It stands for machine-readable file, although that sounds not so right. MIF file basically archives a bunch of file without compression, and no name at all.</p><p>The code is written in C++, and scripting interface is in Python. You can use it without EKA2L1, just make sure to have symemu2.common module</p><figure class="kg-card kg-image-card"><img src="../content/images/2019/04/image-2.png" class="kg-image"></figure><p></p><p>18/4/2019</p><figure class="kg-card kg-image-card"><img src="../content/images/2019/05/image-1.png" class="kg-image"></figure><p>Nikita joins in and help me with the keymapping issue that I was lazy to do.</p><p>7:50PM 19/4/2019</p><p><img src="https://media.discordapp.net/attachments/431430141319708692/568774111724175371/unknown.png?width=760&amp;height=428" alt="GUI change"></p>
<p>I work on miscs stuff. Add an option to change the background. I think these misc stuffs will be cool in the future</p>
<p>29/4/2019:</p><figure class="kg-card kg-image-card"><img src="../content/images/2019/05/image-3.png" class="kg-image"></figure><p>This image is a result of work on 29/4. On 4 days, I implement app registry parsing.</p><p>Normally, Symbian won't try to find any apps with exe to add to menu. App has to register itself to a framework, called AppList. AppList will parse registeration info and add it to the list of apps supported.</p><p>The image lists all the app register to AppList. We rewrite the server with HLE, so we have full control of it. I intend to display app list in main screen and let user choose what app/game to run, but we will have to leave that in the future.</p><p>Also, there is an IO speedup for Windows. We don't need to lowercase the emulated path anymore, Windows will do it for us ;), since both Windows And Symbian is case-insensitive.</p><p>1/5/2019:</p><p>I rework on the config system. I was rushing for many things that I didn't really notice that the emulator is a mess for users. There are 3 config files at that point: 1 for core, 2 for backend (the GUI and the console). The new commit wraps them up to only one config, sharing across the emulator.</p><p>All configs are in a <strong>ConfigState. </strong>I also take the chance to implement a configuration window.</p><figure class="kg-card kg-image-card"><img src="../content/images/2019/05/image-2.png" class="kg-image"></figure><p>Quite comfy? Right?</p><p>4/3/2019:</p><p>I begin to rewrite the memory system of the emulator, to cloest to what it actually does.</p><p>The thing is: currently the memory system is bottleneck. I write it in a short time, and also without proper design, just to make it work, so it's firstly my fault. Now there is no pressure (I don't take Patreon money anymore), also with Nikita helps me at some part, I decided I will rewrite the memory system, closest to what Symbian actually does.</p><p>I want the emulator to be as optimise and less memory-consuming as possible. If we are gonna have to run and emulate a lot of process, the emulator fail the goal miserably. The reason is:</p><ul><li><em>The page table:</em> Emulators like Citra or Yuzu have support for multi-process. But the page table literally consumes 4MB. The reason is I think multi-process is just a way of debug and reverse-engineering stuffs, so optimisations for it were ignored. For our case, launching external process is not a weird behavior, but we might encounter it more frequently. Game consoles are having their ROM and CD games work with what available on the system. On phone, we might have to install more stuffs to get apps working. The page and page table is a neccessary things to be considered about, yet if we decide to use page table, it may cause more than 4MB. So I decide i'm gonna go with page directory. Page directory contains pointers to page table, so resources will be allocated when we needed.</li><li><em>The speed: </em>A failure in my designs. There are two global page infos: user global and user code. However, the memory system don't keep track of all page tables whatsoever. So each time a context switch happens, we have to copy all the pages info in global page infos to the current page table. Doing the same things will user code page infos take total of 0.2ms, which is horrible. Also, the JIT mapping/unmapping is a nightmare, I won't go into detail but it slow down stuffs because I didn't optimize well.</li></ul><p>The new memory system will be design with two models. I only use one at the moment, which S60 is using:</p><ul><li>Moving: One page directory for all the system. Not sure how will context switch will go.</li><li>Multiple: Multiple page directory for all the system. Symbian taken ARMv6 advantages (TTBR0 and TTBR1), to add global page directory and local page directory. Global page directory points to region from ROM to kernel base and upper, whether local page directory points to user process's page directory. We are currently working with this one, seems more generous.</li></ul>
                </div>
            </section>


            <footer class="post-full-footer">


                    
<section class="author-card">
        <span class="avatar-wrapper"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg>
</span>
    <section class="author-card-content">
        <h4 class="author-card-name"><a href="../author/pent0/index.html">Do Trong Thu</a></h4>
            <p>Read <a href="../author/pent0/index.html">more posts</a> by this author.</p>
    </section>
</section>
<div class="post-full-footer-right">
    <a class="author-card-button" href="../author/pent0/index.html">Read More</a>
</div>


            </footer>


        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">

                <article class="post-card post ">

    <a class="post-card-image-link" href="../artworks/index.html">
        <img class="post-card-image"
            srcset="../content/images/size/w300/2019/03/me1-1.png 300w,
                   ../content/images/size/w600/2019/03/me1-1.pngg 600w,
                  ../content/images/size/w1000/2019/03/me1-1.pngng 1000w,
                 ../content/images/size/w2000/2019/03/me1-1.pngpng 2000w"
            sizes="(max-width: 1000px) 400px, 700px"
            src="../content/images/size/w600/2019/03/me1-1.png"
            alt="Artworks"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../artworks/index.html">

            <header class="post-card-header">
                <h2 class="post-card-title">Artworks</h2>
            </header>

            <section class="post-card-excerpt">
                <p>I did some artworks, its relatively simple, and its more of a personal project, but I will just make a gallery of them here:PenBunkyCloudy guyThere is a Mob Psycho 100's percent counter</p>
            </section>

        </a>

        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        Do Trong Thu
                    </div>

                        <a href="../author/pent0/index.html" class="static-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg>
</a>
                </li>
            </ul>

            <span class="reading-time">2 min read</span>

        </footer>

    </div>

</article>

                <article class="post-card post tag-eka2l1 ">

    <a class="post-card-image-link" href="../eka2l1-till-today-part-3/index.html">
        <img class="post-card-image"
            srcset="../content/images/size/w300/2019/01/HelloWorld1-1.png 300w,
                   ../content/images/size/w600/2019/01/HelloWorld1-1.pngg 600w,
                  ../content/images/size/w1000/2019/01/HelloWorld1-1.pngng 1000w,
                 ../content/images/size/w2000/2019/01/HelloWorld1-1.pngpng 2000w"
            sizes="(max-width: 1000px) 400px, 700px"
            src="../content/images/size/w600/2019/01/HelloWorld1-1.png"
            alt="EKA2L1 till today (Part 3)"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../eka2l1-till-today-part-3/index.html">

            <header class="post-card-header">
                    <span class="post-card-tags">EKA2L1</span>
                <h2 class="post-card-title">EKA2L1 till today (Part 3)</h2>
            </header>

            <section class="post-card-excerpt">
                <p>The last 3 months have huge progress. You may notices that the render window doesn't show up lately. It's because I get rid of it.12:31 October 20 2018 At that time</p>
            </section>

        </a>

        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        Do Trong Thu
                    </div>

                        <a href="../author/pent0/index.html" class="static-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg>
</a>
                </li>
            </ul>

            <span class="reading-time">5 min read</span>

        </footer>

    </div>

</article>

        </div>
    </div>
</aside>

<div class="floating-header">
    <div class="floating-header-logo">
        <a href="../index.html">
            <span>pent0</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">EKA2l1 progress (part 4)</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=EKA2l1%20progress%20(part%204)&amp;url=http://localhost:2368/eka2l1-progress-part-4/"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:2368/eka2l1-progress-part-4/"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
        </a>
    </div>
    <progress id="reading-progress" class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="../index.html">pent0</a> &copy; 2019</section>
                <nav class="site-footer-nav">
                    <a href="../index.html">Latest Posts</a>
                    
                    <a href="https://twitter.com/hgen264" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>


    <script>
        var images = document.querySelectorAll('.kg-gallery-image img');
        images.forEach(function (image) {
            var container = image.closest('.kg-gallery-image');
            var width = image.attributes.width.value;
            var height = image.attributes.height.value;
            var ratio = width / height;
            container.style.flex = ratio + ' 1 0%';
        })
    </script>


    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="http://localhost:2368/assets/built/jquery.fitvids.js?v=b5a2b1eda7"></script>


    <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('#reading-progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();

});
</script>


    

</body>
</html>
